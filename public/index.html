<!DOCTYPE HTML>

<html>
	<head>
		<title>Gieun_Younjuin</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Header -->
		<header id="header">
			<h1>Big Picture</h1>
			<nav>
				<ul>
					<li><a href="#intro">Main</a></li>
					<li><a href="#one">Invitation</a></li>
					<li><a href="#two">Who I Am</a></li>
					<li><a href="#work">Gallery</a></li>
					<li><a href="#three">Map</a></li>
					<li><a href="#contact">comments</a></li>
				</ul>
			</nav>
		</header>

		<!-- Intro -->
		<section id="intro" class="main style1 dark fullscreen">
			<div class="content">
				<header>
					<h2>Wedding Day.</h2>
				</header>
				<p>Welcome to <strong>Big Picture</strong> a responsive site template designed by <a href="https://html5up.net">HTML5 UP</a><br />
				and released for free under the <a href="https://html5up.net/license">Creative Commons Attribution license</a>.</p>
				<footer>
					<a href="#one" class="button style2 down">More</a>
				</footer>
			</div>
		</section>

		<!-- 초대합니다. -->
		<section id="one" class="main style2 right dark fullscreen">
			<div class="content box style2">
				<header>
					<h2>초대합니다.</h2>
				</header>
				<p>꽃향기 가득한 봄날,</p>
				<p>	평생 손잡고 나아갈 인연을 만나</p>
				<p>	영원을 약속합니다.</p>
				<p>	봄날에 화사하게 수놓은 햇살처럼</p>
				<p>	서로에게 빛이 되어 밝게 비추겠습니다.</p>
			</div>
		</section>

		<!-- Two -->
		<section id="two" class="main style2 left dark fullscreen">
			<div class="content box style2">
				<header>
					<h2>Who I Am</h2>
				</header>
				<p>Lorem ipsum dolor sit amet et sapien sed elementum egestas dolore condimentum.
				Fusce blandit ultrices sapien, in accumsan orci rhoncus eu. Sed sodales venenatis arcu,
				id varius justo euismod in. Curabitur egestas consectetur magna.</p>
			</div>
		</section>

		<!-- Work -->
		<section id="work" class="main style3 primary">
			<div class="content">
				<header>
					<h2>Gallery</h2>
					<p>갤러리 문구.</p>
				</header>
					<!-- Gallery  -->
					<div class="gallery">
						<article class="from-left">
							<a href="images/fulls/01.jpg" class="image fit"><img src="images/thumbs/01.jpg" title="The Anonymous Red" alt="" /></a>
						</article>
						<article class="from-right">
							<a href="images/fulls/02.jpg" class="image fit"><img src="images/thumbs/02.jpg" title="Airchitecture II" alt="" /></a>
						</article>
						<article class="from-left">
							<a href="images/fulls/03.jpg" class="image fit"><img src="images/thumbs/03.jpg" title="Air Lounge" alt="" /></a>
						</article>
						<article class="from-right">
							<a href="images/fulls/04.jpg" class="image fit"><img src="images/thumbs/04.jpg" title="Carry on" alt="" /></a>
						</article>
						<article class="from-left">
							<a href="images/fulls/05.jpg" class="image fit"><img src="images/thumbs/05.jpg" title="The sparkling shell" alt="" /></a>
						</article>
						<article class="from-right">
							<a href="images/fulls/06.jpg" class="image fit"><img src="images/thumbs/06.jpg" title="Bent IX" alt="" /></a>
						</article>
					</div>
				</div>
		</section>

		<!-- Three -->
		<section id="three" class="main style4 dark fullscreen">
			<div class="content box style2">
				<header>
					<h2>오시는 길</h2>
				</header>
			</div>
			<!-- * 카카오맵 - 지도퍼가기 -->
			<!-- 1. 지도 노드 -->
			<div id="daumRoughmapContainer1721881645796" class="root_daum_roughmap root_daum_roughmap_landing"></div>
		</section>

		<!-- 축하메세지 -->
		<section id="contact" class="main style3 secondary">
			<div class="content">
				<header>
					<div id="comments-section" class="comments-slider">
						<!-- 댓글이 이곳에 표시됩니다 -->
					</div>
					<h2>Comment</h2>
				</header>
				<div class="box">
					<form id="commentForm">
						<div class="fields">
							<div class="field half">
								<input type="text" id="myname" name="myname" placeholder="Name" autocomplete="name" />
							</div>
							<div class="field">
								<textarea id="comment" name="comment" placeholder="Write your comment here" autocomplete="off"></textarea>
							</div>
						</div>
						<ul class="actions special">
							<li><input type="submit" value="Send Message" /></li>
						</ul>
					</form>
				</div>
			</div>


		</section>

		<!-- Footer -->
		<footer id="footer">
				<!-- Menu -->
				<ul class="menu">
					<li>&copy; Wedding</li><li>Design: Younjin</li>
				</ul>
			</footer>



		<!-- Scripts -->
		<script src="assets/js/jquery.min.js"></script>
		<script src="assets/js/jquery.poptrox.min.js"></script>
		<script src="assets/js/jquery.scrolly.min.js"></script>
		<script src="assets/js/jquery.scrollex.min.js"></script>
		<script src="assets/js/browser.min.js"></script>
		<script src="assets/js/breakpoints.min.js"></script>
		<script src="assets/js/util.js"></script>
		<script src="assets/js/main.js"></script>
		<!-- 카카오 지도 스크립트 -->
		<script charset="UTF-8" class="daum_roughmap_loader_script" src="https://ssl.daumcdn.net/dmaps/map_js_init/roughmapLoader.js"></script>
		<script charset="UTF-8">
			new daum.roughmap.Lander({
           	    "timestamp" : "1721881645796",
               	"key" : "2k69x",
                "mapWidth" : "640",
   	            "mapHeight" : "360"
       	    }).render();
		</script>

		<!-- DB 댓글 연동 및 슬라이딩 기능을 위한 스크립트 -->
		<script>
			let currentIndex = 0;
            let commentInterval;

            const loadComments = async () => {
                try {
                    const response = await fetch('/.netlify/functions/getComments');
                    const comments = await response.json();
                    console.log('Comments:', comments);
                    displayComments(comments);
                } catch (error) {
                    console.error('Error loading comments:', error);
                }
            };

            const displayComments = (comments) => {
                const commentsSection = document.getElementById('comments-section');
                commentsSection.innerHTML = '';

                if (comments.length === 0) {
                    commentsSection.innerHTML = '<p>작성된 댓글이 없습니다. 축하메세지를 남겨주세요!</p>';
                } else if (comments.length === 1) {
                    commentsSection.innerHTML = `
                        <div class="comment-slide">
                            <strong>${comments[0].myname}</strong>
                            <br>
                            ${comments[0].comment}
                        </div>`;
                } else {
                    commentsSection.innerHTML = comments.map(comment =>
                        `<div class="comment-slide">
                            <strong>${comment.myname}</strong>
                            <br>
                            ${comment.comment}
                        </div>`
                    ).join('');

                    // 슬라이딩이 발생하도록 하기 위해 딜레이를 주어 슬라이딩 애니메이션이 적용되도록 함
                    setTimeout(() => {
                        startSlidingComments();
                    }, 100); // 100ms 정도의 딜레이를 추가하여 CSS가 먼저 반영된 후 슬라이딩 동작이 시작되도록 함
                }
            };

            const startSlidingComments = () => {
                const commentsSection = document.getElementById('comments-section');
                let index = 0;

                commentInterval = setInterval(() => {
                    index++;
                    commentsSection.style.transform = `translateX(-${index * 100}%)`;

                    if (index === commentsSection.children.length) {
                        setTimeout(() => {
                            commentsSection.style.transition = 'none';
                            commentsSection.style.transform = 'translateX(0)';
                            index = 0;
                            setTimeout(() => {
                                commentsSection.style.transition = 'transform 0.5s ease';
                            }, 50);
                        }, 500);
                    }
                }, 2000);
            };

            const submitComment = async (event) => {
    			event.preventDefault();
			    const myname = document.getElementById('myname').value;
			    const comment = document.getElementById('comment').value;

    			if (!myname || !comment) {
			        alert('Name and comment are required.');
			        return;
			    }

			    const response = await fetch('/.netlify/functions/saveComment', {
			        method: 'POST',
			        headers: {
            			'Content-Type': 'application/json'
			        },
			        body: JSON.stringify({ myname, comment })  // myname과 comment를 JSON으로 전송
			    });

			    if (response.ok) {
			        await loadComments();
			        alert('댓글이 성공적으로 저장되었습니다');
			    } else {
			        const result = await response.json();
			        alert(result.message);
			    }
			};


            document.getElementById('commentForm').addEventListener('submit', submitComment);
            window.onload = loadComments;
		</script>

	</body>
</html>